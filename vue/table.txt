<!DOCTYPE html>
<html>
<head>
    <title>Task List</title>
    <meta charset="utf-8">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <style>
        /* The side navigation menu */
        .sidenav {
            height: 100%; /* 100% Full-height */
            width: 0; /* 0 width - change this with JavaScript */
            position: fixed; /* Stay in place */
            z-index: 1; /* Stay on top */
            top: 0;
            left: 0;
         /*  background-color: #111; *//* Black*/
            background-color: #ffffff;
            overflow-x: hidden; /* Disable horizontal scroll */
            padding-top: 60px; /* Place content 60px from the top */
            transition: 0.5s; /* 0.5 second transition effect to slide in the sidenav */
        }

        /* The navigation menu links */
        .sidenav a {
            padding: 8px 8px 8px 32px;
            text-decoration: none;
            font-size: 25px;
            color: #000000;
            display: block;
            transition: 0.3s;
        }

        /* When you mouse over the navigation links, change their color */
        .sidenav a:hover{
            color: #f1f1f1;
        }

        /* Position and style the close button (top right corner) */
        .sidenav .closebtn {
            position: absolute;
            top: 0;
            right: 25px;
            font-size: 36px;
            margin-left: 50px;
        }

        /* Style page content - use this if you want to push the page content to the right when you open the side navigation */


        /* On smaller screens, where height is less than 450px, change the style of the sidenav (less padding and a smaller font size) */
        @media screen and (max-height: 450px) {
            .sidenav {padding-top: 15px;}
            .sidenav a {font-size: 18px;}
        }
    </style>
</head>
<body>
<script src="https://cdn.jsdelivr.net/npm/vue"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.5.17-beta.0/vue.js"></script>
<script src="https://rawgit.com/matfish2/vue-tables-2/master/dist/vue-tables-2.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" />




<div id="app">

    <!--слайдер навигации -->
    <div  ref="mySidenav" id="mySidenav" class="sidenav">
        <a @click="closeNav" class="closebtn">&times;</a>
        <input type="text" v-model="text" v-on:change="checInput(text)"  name="text" >
        <button v-on:click="saveText" class="btn btn-default" v-bind:disabled="text === ''">Добавить задачу</button>
    </div>

    <!--кнопка навигации -->
    <button @click="openNav">open</button>

    <!--таблицы -->
    <v-client-table :columns="columns" :data="data" :options="options">
    </v-client-table>
</div>





<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script type="text/javascript">
    Vue.use(VueTables.ClientTable);
    new Vue({
        el: "#app",
        data: {
            columns: [
                'id',
                'text',
                'date_current'
            ],
            data: getData(),
            options: {
                headings: {
                    id: 'id',
                    text: 'text',
                    date: 'date_current'
                },
                sortable: [
                    'id', 'text','date_current'
                ],
                texts: {
                    filterPlaceholder: 'filter...'
                }
            },
            data2:''
        },
        methods: {
            //open menu
            openNav() {
                /* Set the width of the side navigation to 250px and the left margin of the page content to 250px */
                var vm = this;
                if (vm.$refs.mySidenav.style.width == "250px") {
                    vm.$refs.mySidenav.style.width = "0px";
                    vm.$refs.main.style.marginRight = "0px";
                }
                else {
                    vm.$refs.mySidenav.style.width = "250px";
                    vm.$refs.main.style.marginRight = "250px";
                }

            },
            closeNav() {
                /* Set the width of the side navigation to 0 and the left margin of the page content to 0 */
                var vm = this;
                vm.$refs.mySidenav.style.width = "0";
                vm.$refs.main.style.marginRight = "0";
            },
            saveText(){
                this.text2=this.text;
                console.log('input '+ this.text);

                const data={
                    text:this.text
                }

                axios.post('http://task.ru.xsph.ru/task.php',
                    'text='+this.text
                )
                    .then(res => {
                        console.log(res)
                        //   this.closeNav()
                        showModal: true

                      //  this.getUsers()
                        this.closeNav()

                    })
                    .catch(error => {
                        console.log(error)
                        showModal:true
                       // this.getUsers()
                    })

            }
        }
    });

    function getData() {
       test=[];

        data2= [
            {
                'id': 1,
                'text': 'sample1',
                'email': 'sample1@example.com',
                'group_name': 'Personnel Department'
            },
            {
                'id': 2,
                'text': 'sample2',
                'email': 'sample2@example.com',
                'group_name': 'Personnel Department'
            },

            {
                'id': 3,
                'text': 'sample3',
                'email': 'sample3@example.com',
                'group_name': 'Accounting department'
            },
            {
                'id': 4,
                'name': 'sample4',
                'email': 'sample4@example.com',
                'group_name': 'General Affairs Department'
            }
        ];
        axios
            .get('http://task.ru.xsph.ru/task.php')
            .then(
                response=> {
                    console.log(response);
                //    this.tasks=response.data;
                    test=response.data;
                }
            )
            .catch(
                error=>console.log(error)
            )

            console.log(test)


      return test.array;


    }
</script>


</body>
</html>